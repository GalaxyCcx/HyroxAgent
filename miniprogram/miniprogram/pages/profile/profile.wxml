<!--ä¸ªäººèµ„æ–™é¡µ-->
<view class="page-container">
  <view class="content">
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <block wx:if="{{!isLoggedIn}}">
      <view class="login-section">
        <view class="login-icon">ğŸ‘¤</view>
        <text class="login-title">ç™»å½• HYROX Agent</text>
        <text class="login-desc">ç™»å½•åå¯ä¿å­˜æ¯”èµ›æ•°æ®ã€æŸ¥çœ‹å†å²è®°å½•</text>
        
        <button 
          class="login-btn {{isLoading ? 'loading' : ''}}"
          bindtap="onLogin"
          disabled="{{isLoading}}"
        >
          <text class="btn-icon" wx:if="{{!isLoading}}">ğŸ”</text>
          <view class="loading-spinner" wx:if="{{isLoading}}"></view>
          <text class="btn-text">{{isLoading ? 'ç™»å½•ä¸­...' : 'å¾®ä¿¡ä¸€é”®ç™»å½•'}}</text>
        </button>
        
        <text class="login-tip">ç™»å½•å³è¡¨ç¤ºåŒæ„æœåŠ¡æ¡æ¬¾å’Œéšç§æ”¿ç­–</text>
      </view>

      <!-- æœç´¢å…¥å£ -->
      <view class="guest-search" bindtap="onGoSearch">
        <text class="search-icon">ğŸ”</text>
        <text class="search-text">ä¸ç™»å½•ä¹Ÿå¯ä»¥æœç´¢è¿åŠ¨å‘˜</text>
        <text class="search-arrow">â†’</text>
      </view>
    </block>

    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <block wx:else>
      <!-- å¤´åƒåŒºåŸŸ -->
      <view class="profile-header">
        <view class="avatar-wrapper" bindtap="onEditProfile">
          <image 
            class="avatar-img" 
            src="{{user.avatar_url}}" 
            mode="aspectFill"
            wx:if="{{user.avatar_url}}"
          />
          <view class="avatar-placeholder" wx:else>
            <text class="avatar-text">{{user.nickname ? user.nickname[0] : '?'}}</text>
          </view>
        </view>
        
        <view class="user-info" bindtap="onEditProfile">
          <text class="user-name">{{user.nickname || 'ç‚¹å‡»è®¾ç½®æ˜µç§°'}}</text>
          <view class="user-tags">
            <text class="tag id-tag">ID: {{user.id}}</text>
          </view>
        </view>
        
        <view class="settings-btn" bindtap="onSettings">
          <text class="settings-icon">âš™ï¸</text>
        </view>
      </view>

      <!-- ç»Ÿè®¡æ•°æ® -->
      <view class="stats-grid">
        <view class="stat-card">
          <text class="stat-label">å·²å®Œæˆæ¯”èµ›</text>
          <text class="stat-value">{{stats.completed}}</text>
        </view>
        <view class="stat-card highlight">
          <text class="stat-label primary">ä¸ªäººæœ€ä½³ (PB)</text>
          <text class="stat-value">{{stats.pb}}</text>
        </view>
        <view class="stat-card">
          <text class="stat-label">å¹´é¾„ç»„</text>
          <text class="stat-value">{{stats.ageGroup}}</text>
        </view>
        <view class="stat-card">
          <text class="stat-label">æœ€è¿‘ä¸€åœºæ’å</text>
          <text class="stat-value">{{stats.rank}}</text>
        </view>
      </view>

      <!-- Tab æ  -->
      <view class="tabs">
        <view 
          class="tab {{activeTab === 'races' ? 'active' : ''}}"
          data-tab="races"
          bindtap="onTabChange"
        >æ¯”èµ›</view>
        <view 
          class="tab {{activeTab === 'training' ? 'active' : ''}}"
          data-tab="training"
          bindtap="onTabChange"
        >è®­ç»ƒæ•°æ®</view>
      </view>

      <!-- æœç´¢å…¥å£ -->
      <view class="search-entry" bindtap="onGoSearch">
        <text class="search-icon">ğŸ”</text>
        <text class="search-text">æœç´¢å…¶ä»–è¿åŠ¨å‘˜...</text>
        <text class="search-arrow">â†’</text>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state">
        <view class="empty-icon">ğŸƒ</view>
        <text class="empty-title">æš‚æ— æ¯”èµ›æ•°æ®</text>
        <text class="empty-desc">æœç´¢è¿åŠ¨å‘˜æŸ¥çœ‹æ¯”èµ›æˆç»©</text>
        <view class="empty-btn" bindtap="onGoSearch">
          <text>å»æœç´¢</text>
        </view>
      </view>
    </block>
  </view>
</view>
