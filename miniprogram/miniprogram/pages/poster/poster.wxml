<!--æˆ˜æŠ¥æµ·æŠ¥é¡µ-->
<view class="poster-page">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½æŠ¥å‘Šæ•°æ®...</text>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view wx:elif="{{error}}" class="error-container">
    <view class="error-icon">!</view>
    <text class="error-text">{{error}}</text>
    <button class="retry-btn" bind:tap="loadReport">é‡è¯•</button>
  </view>

  <!-- æµ·æŠ¥å†…å®¹ -->
  <view wx:else class="poster-content">
    <!-- æµ·æŠ¥é¢„è§ˆ -->
    <view class="poster-preview">
      <view class="poster-card" id="poster-canvas">
        <!-- å¤´éƒ¨è£…é¥° -->
        <view class="poster-header">
          <view class="header-gradient"></view>
          <view class="header-content">
            <text class="brand-text">HYROX</text>
            <text class="event-text">{{report.location}} {{report.season}}</text>
          </view>
        </view>

        <!-- ä¸»ä½“å†…å®¹ -->
        <view class="poster-body">
          <!-- è¿åŠ¨å‘˜ä¿¡æ¯ -->
          <view class="athlete-section">
            <text class="athlete-name">{{report.athlete_name}}</text>
            <view class="athlete-tags">
              <text class="tag">{{report.division || 'OPEN'}}</text>
              <text class="tag">{{report.gender === 'male' ? 'ç”·å­' : 'å¥³å­'}}</text>
            </view>
          </view>

          <!-- æ ¸å¿ƒæ•°æ® -->
          <view class="data-section">
            <view class="data-item main">
              <text class="data-label">å®Œèµ›æ—¶é—´</text>
              <text class="data-value">{{report.total_time || '--:--:--'}}</text>
            </view>
            <view class="data-row">
              <view class="data-item">
                <text class="data-label">æ€»æ’å</text>
                <text class="data-value">#{{report.overall_rank || '-'}}</text>
              </view>
              <view class="data-item">
                <text class="data-label">ç»„åˆ«æ’å</text>
                <text class="data-value">#{{report.division_rank || '-'}}</text>
              </view>
            </view>
          </view>

          <!-- AI æ€»ç»“ -->
          <view class="summary-section" wx:if="{{report.summary}}">
            <view class="summary-header">
              <text class="summary-icon">ğŸ§ </text>
              <text class="summary-title">AI åˆ†æ</text>
            </view>
            <text class="summary-text">{{report.summary}}</text>
          </view>

          <!-- äº®ç‚¹æ ‡ç­¾ -->
          <view class="highlights-section" wx:if="{{report.strengths && report.strengths.length > 0}}">
            <view class="highlight-tag" wx:for="{{report.strengths}}" wx:key="index" wx:if="{{index < 3}}">
              <text class="highlight-icon">âœ“</text>
              <text class="highlight-text">{{item}}</text>
            </view>
          </view>
        </view>

        <!-- åº•éƒ¨ -->
        <view class="poster-footer">
          <view class="qrcode-placeholder">
            <text class="qr-text">æ‰«ç æŸ¥çœ‹</text>
            <text class="qr-text">å®Œæ•´æŠ¥å‘Š</text>
          </view>
          <view class="footer-info">
            <text class="footer-brand">HYROX Agent</text>
            <text class="footer-slogan">ä½ çš„ç§äºº HYROX æ•™ç»ƒ</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="action-btn primary" bind:tap="onSavePoster">
        <text class="btn-icon">ğŸ“¥</text>
        <text>ä¿å­˜åˆ°ç›¸å†Œ</text>
      </button>
      <button class="action-btn secondary" open-type="share">
        <text class="btn-icon">â†—</text>
        <text>åˆ†äº«ç»™å¥½å‹</text>
      </button>
    </view>

    <!-- æç¤º -->
    <text class="tip-text">é•¿æŒ‰æµ·æŠ¥å¯ä¿å­˜æˆ–åˆ†äº«</text>
  </view>
</view>
