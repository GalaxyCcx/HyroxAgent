{
  "section_id": "deep_dive",
  "description": "æ·±åº¦å¤ç›˜ç« èŠ‚ - å¿ƒç‡é…é€Ÿè§£è€¦åˆ†æï¼ˆæ”¯æŒé™çº§æ¨¡å¼ï¼‰",
  
  "tool": {
    "type": "function",
    "function": {
      "name": "generate_deep_dive_section",
      "description": "ç”Ÿæˆæ·±åº¦å¤ç›˜ç« èŠ‚çš„å®Œæ•´å†…å®¹ï¼ŒåŒ…å«å¿ƒç‡é…é€Ÿè§£è€¦åˆ†æï¼ˆæˆ–é™çº§ä¸ºçº¯é…é€Ÿåˆ†æï¼‰",
      "parameters": {
        "type": "object",
        "properties": {
          
          "has_heart_rate_data": {
            "type": "boolean",
            "description": "æ˜¯å¦æœ‰å¿ƒç‡æ•°æ®"
          },
          
          "analysis_type": {
            "type": "string",
            "enum": ["full", "degraded"],
            "description": "åˆ†æç±»å‹ï¼šfull=å®Œæ•´å¿ƒç‡åˆ†æï¼Œdegraded=é™çº§é…é€Ÿåˆ†æ"
          },
          
          "intro_quote": {
            "type": "string",
            "description": "2.1 å¼•è¨€ä¸€å¥ï¼Œç»¿è‰²å¼•ç”¨æ¡†ï¼Œå¦‚ï¼šæˆ‘ä»¬è¦çœ‹çš„ä¸æ˜¯å¿ƒç‡å¤šé«˜ï¼Œè€Œæ˜¯å¿ƒç‡å’Œé…é€Ÿä»€ä¹ˆæ—¶å€™ã€Œåˆ†æ‰‹ã€"
          },
          
          "decoupling_chart": {
            "type": "object",
            "description": "è§£è€¦å›¾æ•°æ®ï¼šåŒè½´é…é€Ÿ(s/km)ä¸å¿ƒç‡(bpm)ï¼Œè„±é’©åŒºåŸŸ Run6â€“Run8",
            "properties": {
              "data": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "segment": { "type": "string" },
                    "pace_seconds": { "type": "number", "description": "é…é€Ÿç§’æ•°/km" },
                    "hr": { "type": "number", "description": "å¿ƒç‡ bpm" }
                  }
                }
              },
              "decoupling_zone": {
                "type": "object",
                "properties": {
                  "start": { "type": "string", "description": "å¦‚ Run6" },
                  "end": { "type": "string", "description": "å¦‚ Run8" }
                }
              }
            }
          },
          
          "phase_analysis": {
            "type": "array",
            "description": "é˜¶æ®µåˆ†æï¼ˆLLM è¾“å‡ºï¼‰ï¼Œæ¯é˜¶æ®µï¼šæ ‡é¢˜ã€æ•°æ®è¡Œã€ç»“è®ºï¼ˆsuccess/warningï¼‰",
            "items": {
              "type": "object",
              "properties": {
                "title": { "type": "string" },
                "icon": { "type": "string", "description": "å¦‚ ğŸ“" },
                "metrics": { "type": "string", "description": "æ•°æ®è¡Œ" },
                "detail": { "type": "string" },
                "status": { "type": "string", "enum": ["success", "warning"] },
                "conclusion": { "type": "string", "description": "ç»“è®ºå¥" }
              }
            }
          },
          
          "zonex_conclusion": {
            "type": "object",
            "description": "ZONEÃ˜ ç»“è®ºï¼ˆLLM è¾“å‡ºï¼‰ï¼Œçº¢è‰²è­¦å‘Šæ¡†",
            "properties": {
              "title": { "type": "string", "description": "å¦‚ ZONEÃ˜ ç»“è®º" },
              "content": { "type": "string" }
            }
          },
          
          "roxzone_intro_quote": {
            "type": "string",
            "description": "2.2 è½¬æ¢åŒºå¼•è¨€ä¸€å¥"
          },
          
          "roxzone_comparison_chart": {
            "type": "object",
            "description": "Roxzone æ€»è€—æ—¶å¯¹æ¯”ï¼šä½  / Top10% / å¹³å‡",
            "properties": {
              "you": { "type": "object", "properties": { "label": { "type": "string" }, "value": { "type": "string" }, "seconds": { "type": "number" } } },
              "top10": { "type": "object", "properties": { "label": { "type": "string" }, "value": { "type": "string" }, "seconds": { "type": "number" } } },
              "avg": { "type": "object", "properties": { "label": { "type": "string" }, "value": { "type": "string" }, "seconds": { "type": "number" } } }
            }
          },
          
          "roxzone_behavior_analysis": {
            "type": "array",
            "description": "è¡Œä¸ºåˆ†æï¼ˆLLM è¾“å‡ºï¼‰ï¼Œæ¯é¡¹ title + content",
            "items": {
              "type": "object",
              "properties": {
                "title": { "type": "string" },
                "content": { "type": "string" }
              }
            }
          },
          
          "roxzone_suggestion": {
            "type": "string",
            "description": "å¯æ‰§è¡Œå»ºè®®ï¼ˆLLM è¾“å‡ºï¼‰ï¼Œç»¿è‰²æ¡† + ğŸ’¡"
          },
          
          "hr_pace_chart": {
            "type": "object",
            "description": "å¿ƒç‡é…é€ŸåŒè½´å›¾ï¼ˆä»…å®Œæ•´åˆ†ææ¨¡å¼ï¼‰",
            "properties": {
              "data_id": {
                "type": "string",
                "description": "å¼•ç”¨çš„å¿ƒç‡æ•°æ®IDï¼ˆç”±ç³»ç»Ÿå¡«å……ï¼‰"
              },
              "show_zones": {
                "type": "boolean",
                "default": true,
                "description": "æ˜¯å¦æ˜¾ç¤ºå¿ƒç‡åŒºé—´"
              }
            }
          },
          
          "phases": {
            "type": "array",
            "description": "ä¸‰é˜¶æ®µåˆ†æï¼šç¨³æ€æœŸã€è„±é’©æœŸã€å´©ç›˜åŒº",
            "items": {
              "type": "object",
              "properties": {
                "phase_name": {
                  "type": "string",
                  "enum": ["steady_state", "decoupling", "collapse"],
                  "description": "é˜¶æ®µåç§°"
                },
                "segments": {
                  "type": "array",
                  "items": {"type": "string"},
                  "description": "åŒ…å«çš„åˆ†æ®µï¼ˆå¦‚ ['Run1', 'Run2', 'Run3', 'Run4']ï¼‰"
                },
                "avg_hr": {
                  "type": "number",
                  "description": "é˜¶æ®µå¹³å‡å¿ƒç‡ï¼ˆå®Œæ•´åˆ†ææ¨¡å¼ï¼‰"
                },
                "avg_pace": {
                  "type": "number",
                  "description": "é˜¶æ®µå¹³å‡é…é€Ÿï¼ˆåˆ†é’Ÿ/å…¬é‡Œï¼‰"
                },
                "description": {
                  "type": "string",
                  "maxLength": 300,
                  "description": "é˜¶æ®µè¯¦ç»†åˆ†ææè¿°ï¼ˆè‡ªç„¶è¯­è¨€æ®µè½ï¼ŒåŒ…å«æ•°æ®å’Œç”Ÿç†å­¦è§£é‡Šï¼‰"
                }
              },
              "required": ["phase_name", "segments", "description"]
            }
          },
          
          "decoupling_metrics": {
            "type": "object",
            "description": "è§£è€¦æŒ‡æ ‡ï¼ˆä»…å®Œæ•´åˆ†ææ¨¡å¼ï¼‰",
            "properties": {
              "hr_drift_rate": {
                "type": "number",
                "description": "å¿ƒç‡æ¼‚ç§»ç‡ï¼ˆ%ï¼‰"
              },
              "decoupling_point": {
                "type": "integer",
                "minimum": 1,
                "maximum": 8,
                "description": "è§£è€¦å‘ç”Ÿç‚¹ï¼ˆç¬¬å‡ æ®µè·‘æ­¥ï¼‰"
              },
              "efficiency_rating": {
                "type": "string",
                "enum": ["excellent", "good", "fair", "poor"],
                "description": "å¿ƒç‡æ•ˆç‡è¯„çº§"
              }
            }
          },
          
          "pace_trend_chart": {
            "type": "object",
            "description": "é…é€Ÿè¶‹åŠ¿å›¾ï¼ˆé™çº§æ¨¡å¼æˆ–è¾…åŠ©å›¾è¡¨ï¼‰",
            "properties": {
              "data_id": {
                "type": "string",
                "description": "å¼•ç”¨çš„é…é€Ÿæ•°æ®IDï¼ˆç”±ç³»ç»Ÿå¡«å……ï¼‰"
              },
              "show_decay_points": {
                "type": "boolean",
                "default": true,
                "description": "æ˜¯å¦æ ‡è®°è¡°å‡ç‚¹"
              }
            }
          },
          
          "degraded_analysis": {
            "type": "object",
            "description": "é™çº§åˆ†æï¼ˆæ— å¿ƒç‡æ•°æ®æ—¶ä½¿ç”¨ï¼‰",
            "properties": {
              "pace_stability": {
                "type": "string",
                "enum": ["stable", "moderate_decline", "significant_decline"],
                "description": "é…é€Ÿç¨³å®šæ€§è¯„ä¼°"
              },
              "estimated_fatigue_point": {
                "type": "integer",
                "description": "ä¼°è®¡ç–²åŠ³ç‚¹ï¼ˆç¬¬å‡ æ®µï¼‰"
              },
              "recommendation": {
                "type": "string",
                "description": "å»ºè®®ï¼ˆå¦‚å»ºè®®ä¸‹æ¬¡ä½©æˆ´å¿ƒç‡è®¾å¤‡ï¼‰"
              }
            }
          },
          
          "analysis_text": {
            "type": "string",
            "maxLength": 500,
            "description": "åˆ†ææ€»ç»“æ–‡å­—ï¼ˆ100-200å­—ï¼‰ï¼ŒåŒ…å«æ•´ä½“è¯„ä»·å’Œè®­ç»ƒå»ºè®®"
          }
          
        },
        "required": ["has_heart_rate_data", "analysis_type", "intro_quote", "phase_analysis", "zonex_conclusion", "roxzone_intro_quote", "roxzone_comparison_chart", "roxzone_behavior_analysis", "roxzone_suggestion", "analysis_text"]
      }
    }
  },
  
  "tool_choice": {
    "type": "function",
    "function": {
      "name": "generate_deep_dive_section"
    }
  },
  
  "blocks_mapping": {
    "intro_quote": {
      "type": "text",
      "component": "QuoteBox"
    },
    "decoupling_chart": {
      "type": "chart",
      "component": "DecouplingChart"
    },
    "phase_analysis": {
      "type": "list",
      "component": "PhaseAnalysisCard"
    },
    "zonex_conclusion": {
      "type": "card",
      "component": "WarningBox"
    },
    "roxzone_intro_quote": {
      "type": "text",
      "component": "QuoteBox"
    },
    "roxzone_comparison_chart": {
      "type": "chart",
      "component": "RoxzoneCompareChart"
    },
    "roxzone_behavior_analysis": {
      "type": "list",
      "component": "BehaviorAnalysisCard"
    },
    "roxzone_suggestion": {
      "type": "text",
      "component": "SuggestionBox"
    },
    "hr_pace_chart": {
      "type": "chart",
      "component": "HRPaceDualAxis",
      "condition": "has_heart_rate_data === true"
    },
    "phases": {
      "type": "list",
      "component": "PhaseAnalysisList"
    },
    "decoupling_metrics": {
      "type": "card",
      "component": "DecouplingMetrics",
      "condition": "has_heart_rate_data === true"
    },
    "pace_trend_chart": {
      "type": "chart",
      "component": "PaceTrendChart"
    },
    "degraded_analysis": {
      "type": "card",
      "component": "DegradedAnalysisCard",
      "condition": "has_heart_rate_data === false"
    },
    "analysis_text": {
      "type": "text",
      "component": "Paragraph"
    }
  }
}
